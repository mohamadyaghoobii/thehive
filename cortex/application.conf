# Cortex Configuration File
# Version: 3.1.8
# Description: Main configuration file for Cortex

# Secret key - used by Play Framework
play.http.secret.key="cortex-secret-key-change-in-production-12345"

# Database configuration - Elasticsearch
search {
  host = ["127.0.0.1:9200"]
  index = "cortex_6"
  # Elasticsearch authentication (if enabled)
  # http {
  #   auth {
  #     type = basic
  #     basic {
  #       username = "elastic"
  #       password = "your_password"
  #     }
  #   }
  # }
}

# HTTP server configuration
http {
  address = "0.0.0.0"
  port = 9001
  # HTTPS configuration (optional)
  # ssl {
  #   keyStore {
  #     path = "/path/to/keystore.jks"
  #     password = "password"
  #   }
  # }
}

# Authentication configuration
auth {
  basic {
    realm = "Cortex"
  }
}

# Supported authentication methods
auth.methods = [
  {name = "basic"}
  {name = "key"}
]

# Secret for token verification
auth.verification {
  secret = "8RnqzIf7Z4Dw++nDVUoURXY2crGCzN6i"
}

# Analyzer configuration
analyzer {
  # Analyzer locations - can be URLs or local directories
  urls = [
    "https://download.thehive-project.org/analyzers.json"
    # Local analyzers directory (if you download analyzers manually)
    # "/opt/cortex/analyzers"
  ]

  # Analyzer execution configuration
  fork-join-executor {
    # Minimum number of threads
    parallelism-min = 2
    # Parallelism factor (threads = available processors * factor)
    parallelism-factor = 2.0
    # Maximum number of threads
    parallelism-max = 4
  }
  
  # Global analyzer configurations (add API keys here)
  # configs = [
  #   {
  #     name = "VirusTotal_GetReport_3_0"
  #     configuration = {
  #       key = "your-virustotal-api-key"
  #       # Other analyzer-specific settings
  #     }
  #   }
  # ]
}

# Responder configuration
responder {
  # Responder locations
  urls = [
    "https://download.thehive-project.org/responders.json"
    # Local responders directory
    # "/opt/cortex/responders"
  ]

  # Responder execution configuration
  fork-join-executor {
    parallelism-min = 2
    parallelism-factor = 2.0
    parallelism-max = 4
  }
}

# CORS configuration for TheHive integration
play.filters.enabled += "play.filters.cors.CORSFilter"
play.filters.cors {
  pathPrefixes = ["/api"]
  allowedOrigins = ["http://localhost:9000", "http://127.0.0.1:9000", "http://0.0.0.0:9000"]
  allowedHttpMethods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
  allowedHttpHeaders = ["Accept", "Content-Type", "Origin", "X-Requested-With", "Authorization"]
}

# HTTP client configuration
play.ws.timeout.connection = 30s
play.ws.timeout.idle = 30s
play.ws.timeout.request = 30s

# Logging configuration
logger.analyzer = INFO
logger.responder = INFO
logger.cortex = INFO
logger.org.elasticsearch = WARN

# Additional modules
play.modules.enabled += "play.api.libs.ws.ahc.AhcWSModule"